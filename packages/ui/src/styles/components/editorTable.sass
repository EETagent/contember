@import '../common'

.#{$cui-conf-globalPrefix}editorTable
	$frontRowControlsWidth: 2em
	$topColumnControlsHeight: 2em
	$lineThickness: em(1px)
	$addDimensionThickness: 1em
	$verticalOffsetTop: 1em
	$verticalOffsetBottom: 2.5em

	$rowCount: var(--#{$cui-conf-globalPrefix}editorTable-rowCount, 0)
	$columnCount: var(--#{$cui-conf-globalPrefix}editorTable-columnCount, 0)

	display: grid
	grid-template-rows: $topColumnControlsHeight repeat(calc(#{$rowCount}), $lineThickness auto) $lineThickness $addDimensionThickness
	grid-template-columns: $frontRowControlsWidth repeat(calc(#{$columnCount}), $lineThickness 1fr) $lineThickness $addDimensionThickness
	margin: ($verticalOffsetTop - $topColumnControlsHeight) (-$addDimensionThickness) ($verticalOffsetBottom - $frontRowControlsWidth) (-$frontRowControlsWidth)

	&-rowControls,
	&-columnControls,
	&-rowControls-in,
	&-columnControls-in,
	&-body,
	&-row
		display: contents

	$row: var(--#{$cui-conf-globalPrefix}editorTable-row, 0)
	$column: var(--#{$cui-conf-globalPrefix}editorTable-column, 0)
	&-rowControls
		&-item
			grid-row: calc(2 * #{$row} + 3) / span 1
			grid-column: 1 / span 1
			align-self: center
		&-line
			grid-row: calc(2 * #{$row} + 2) / span 1
			grid-column: 2 / -2
			background: $cui-color-gray-2
		&-add
			grid-row: calc(2 * #{$row} + 2) / span 1
			grid-column: 1 / span 1
		&-add:hover + &-line,
		&-add:focus + &-line
			transform: scaleY(4)
	&-columnControls
		&-item
			grid-row: 1 / span 1
			grid-column: calc(2 * #{$column} + 3) / span 1
			justify-self: center
		&-line
			grid-row: 2 / -2
			grid-column: calc(2 * #{$column} + 2) / span 1
			background: $cui-color-gray-2
		&-add
			grid-row: 1 / span 1
			grid-column: calc(2 * #{$column} + 2) / span 1
		&-add:hover + &-line,
		&-add:focus + &-line
			transform: scaleX(4)

	&-rowControls,
	&-columnControls
		&-line
			transition: background-color .2s
		&-add
			justify-self: center
			align-self: center
			> *
				transition: transform .2s
				transform: scale(.4)
			&:hover > *,
			&:focus > *
				transform: scale(1)
		&-add:hover + &-line,
		&-add:focus + &-line
			background-color: $cui-box-active-color
			z-index: 1
	&-rowControls-add,
	&-columnControls-add,
	&-handle,
	&-remove
		> *
			transition: transform .2s
			transform: scale(.4)
		&:hover > *,
		&:focus > *
			transform: scale(1)
	&-handle
		grid-area: 1 / 1 / span 1 / span 1
	&-remove
		grid-area: 1 / -2 / span 1 / span 1
		align-self: center
		padding-left: .6em
		width: 1.5em
	&-cell
		// grid-row: calc(2 * #{$row} + 3) / span 1
		// grid-column: calc(2 * #{$column} + 3) / span 1
		padding: em(2px) em(6px)
	&-appendRow
		grid-row: -2 / span 1
		grid-column: 2 / -2
		border-bottom-left-radius: ($addDimensionThickness / 2)
		border-bottom-right-radius: ($addDimensionThickness / 2)
	&-appendColumn
		grid-row: 2 / -2
		grid-column: -2 / span 1
		border-top-right-radius: ($addDimensionThickness / 2)
		border-bottom-right-radius: ($addDimensionThickness / 2)
	&-appendRow,
	&-appendColumn
		@extend %implementsCustomFocusEffects
		border: none
		background: $cui-color-gray-1
		font-size: .6em
		display: flex
		justify-content: center
		align-items: center
		color: $cui-color-gray-7
		cursor: pointer

		&,
		& > *
			transition-property: background-color, color
			transition-duration: .2s
			transition-timing-function: ease-in-out
		&:hover,
		&:focus
			background-color: $cui-box-active-color
			& > *
				color: $cui-color-white

	&-handle
		&:hover > *
			transform: scale(1)

	&-rowControls-add,
	&-rowControls-item,
	&-columnControls-add,
	&-columnControls-item,
	&-appendRow,
	&-appendColumn,
	&-handle,
	&-remove
		transition-property: visibility, opacity
		transition-duration: .2s
		visibility: hidden
		opacity: 0

	&.is-focused &,
	&:hover &
		&-rowControls-add,
		&-rowControls-item,
		&-columnControls-add,
		&-columnControls-item,
		&-appendRow,
		&-appendColumn,
		&-handle,
		&-remove
			opacity: 1
			visibility: visible
